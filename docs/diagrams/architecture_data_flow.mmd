graph TD
    subgraph "Input Data"
        direction TB
        A1(personalities_db_1-5000.txt)
        A2(base_query.txt)
        A3(config.ini)
    end

    subgraph "Stage 1: Query Generation"
        direction TB
        B(build_queries.py)
        B --> C[llm_query_XXX.txt]
    end
    
    subgraph "Stage 2: LLM Interaction"
        direction TB
        D(run_llm_sessions.py)
        D --> E[llm_response_XXX.txt]
    end
    
    subgraph "Stage 3: Response Processing"
        direction TB
        F(process_llm_responses.py)
        F --> G[all_scores.txt]
        F --> H[all_mappings.txt]
    end

    subgraph "Stage 4: Hierarchical Analysis"
        direction TB
        I(compile_results.py)
        J(run_anova.py)
        K_final[final_summary_results.csv] --> J
        J --> L[MASTER_ANOVA_DATASET.csv]
        J --> N((Plots & Log))
    end

    %% Data Flow Connections
    A1 & A2 & A3 --> B
    C --> D
    E --> F
    A3 --> O(config.ini.archived):::Data
    O & G & H --> I

    classDef Data fill:#e6f3ff,stroke:#007bff
    classDef Script fill:#fff0e6,stroke:#ff7f0e
    class A1,A2,A3,C,E,G,H,K_final,L,N,O Data
    class B,D,F,I,J Script