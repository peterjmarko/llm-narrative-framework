graph TD
    %% 1. Node Definitions
    new_exp["new_experiment.ps1"]
    audit_exp["audit_experiment.ps1"]
    fix_exp["fix_experiment.ps1"]
    audit_stu["audit_study.ps1"]
    compile_stu["compile_study.ps1"]

    exp_manager["experiment_manager.py"]
    exp_auditor["experiment_auditor.py"]
    manage_log["manage_experiment_log.py"]
    compile_exp["compile_experiment_results.py"]

    rep_manager["replication_manager.py"]
    q_gen["query_generator.py"]
    build_q["build_llm_queries.py"]
    prompter["llm_prompter.py"]
    process_resp["process_llm_responses.py"]
    analyze_perf["analyze_llm_performance.py"]
    bias_analysis["run_bias_analysis.py"]
    gen_report["generate_replication_report.py"]
    compile_rep["compile_replication_results.py"]

    compile_study_results["compile_study_results.py"]
    analyze_study_results["analyze_study_results.py"]

    cfg["config_loader.py"]

    %% 2. Link Definitions
    new_exp --> exp_manager
    audit_exp --> exp_auditor
    fix_exp --> exp_manager & exp_auditor
    audit_stu --> exp_auditor
    compile_stu --> compile_study_results

    exp_manager --> manage_log & compile_exp & rep_manager
    
    rep_manager --> build_q
    build_q --> q_gen
    build_q --> prompter --> process_resp --> analyze_perf --> bias_analysis --> gen_report --> compile_rep

    compile_study_results --> analyze_study_results
    
    exp_manager -.-> cfg
    rep_manager -.-> cfg
    compile_study_results -.-> cfg
    analyze_study_results -.-> cfg

    %% 3. Subgraph Grouping
    subgraph "1. Main User Entry Points (.ps1)"
        new_exp; audit_exp; fix_exp; audit_stu; compile_stu;
    end
    subgraph "2. Experiment Lifecycle Management"
        exp_manager; exp_auditor; manage_log; compile_exp;
    end
    subgraph "3. Single Replication Pipeline"
        rep_manager; q_gen; build_q; prompter; process_resp; analyze_perf; bias_analysis; gen_report; compile_rep;
    end
    subgraph "4. Study-Level Analysis"
        compile_study_results; analyze_study_results;
    end
    subgraph "5. Utility & Other Scripts"
        cfg;
    end