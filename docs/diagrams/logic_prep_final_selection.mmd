graph TD
    subgraph Logic for select_final_candidates.py
        A[Start] --> B{Load eligible candidates, OCEAN scores, eminence scores, and country codes};
        B --> C{Create set of final subject IDs from OCEAN scores file};
        C --> D{Filter eligible candidates list by final ID set};
        D --> E{Resolve 'CountryState' code to full 'Country' name};
        E --> F{Join with eminence scores};
        F --> G{Sort final list by eminence score descending};
        G --> H[Write final list to adb_final_candidates.txt];
        H --> I[End];
    end