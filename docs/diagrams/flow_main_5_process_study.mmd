graph TD;
    A[process_study.ps1<br>User Entry Point]:::entry --> B;

    subgraph "Workflow 5: Process a Study"
        direction TB
        
        B["1. Audit Study<br><small>via audit_study.ps1</small>"]:::step;
        C["2. Compile Study Results<br><small>via compile_study_results.py</small>"]:::step;
        D["3. Analyze Study<br><small>via study_analyzer.py</small>"]:::step;

        B --> E{"Audit Result?"}:::decision;
        E -- "Not Validated" --> F((Halt & Report Error)):::stop_node;
        E -- "Already Complete" --> G{"Prompt User to Overwrite?"}:::decision;
        G -- "No" --> H((Exit)):::stop_node;
        G -- "Yes" --> C;
        E -- "Validated & Ready" --> C;
        C --> D;
    end

    subgraph "Key Data Flow"
        direction LR
        E[("EXPERIMENT_results.csv")]:::artifact_in;
        F[("STUDY_results.csv")]:::artifact_mid;
        G[("Final Reports & Plots")]:::artifact_out;
        
        E -- "Reads" --> C;
        C -- "Generates" --> F;
        F -- "Reads" --> D;
        D -- "Generates" --> G;
    end
    
    classDef entry fill:#337ab7,stroke:#2e6da4,color:#fff;
    classDef step fill:#5bc0de,stroke:#46b8da,color:#fff;
    classDef artifact_in fill:#f0f0f0,stroke:#666,color:#333;
    classDef artifact_mid fill:#e9ecef,stroke:#adb5bd,color:#333;
    classDef artifact_out fill:#d4edda,stroke:#155724,color:#333;
    classDef decision fill:#f0ad4e,stroke:#eea236,color:#333;
    classDef stop_node fill:#e74c3c,stroke:#c0392b,color:#fff;