graph TD
    subgraph " "
        style invis stroke-width:0px,fill:transparent

        subgraph "Raw Sources"
            direction LR
            A[adb_raw_export.txt]
            A_new[adb_raw_export_fetched.txt]
            C[eminence_scores.csv]
            D[country_codes.csv]
        end

        subgraph "Intermediate Artifacts"
            direction LR
            F[adb_filtered_5000.txt]
            M[missing_eminence_scores.txt]
            G[sf_data_import.txt]
            H[sf_chart_export.csv]
            I[sf_delineations_library.txt]
            J[neutralized_delineations/]
        end

        subgraph "Processed Artifacts"
            direction LR
            K[subject_db.csv]
        end

        subgraph "Final Product"
            L[personalities_db.txt]
        end
    end
    
    subgraph "Automated Data Fetching"
        F_new[fetch_adb_data.py]
    end

    subgraph "Data Auditing (Optional Pre-flight)"
        E0[validate_adb_data.py]
        R[adb_validation_report.csv]
    end

    F_new -- "creates" --> A_new

    A -- "audits" --> E0
    E0 -- "creates" --> R

    A -- "(static input)" --> E1[filter_adb_candidates.py]
    A_new -- "(fetched input)" --> E1
    R -- "uses" --> E1
    C -- "uses" --> E1
    E1 -- "creates" --> F
    E1 -- "creates" --> M

    F -- "formats" --> E2[prepare_sf_import.py]
    D -- "uses" --> E2
    E2 -- "creates" --> G
    
    G -- "imports/exports" --> P1["Solar Fire Software"]
    P1 -- "creates" --> H
    P1 -- "creates" --> I

    I -- "sanitizes" --> P2["LLM Neutralization"]
    P2 -- "creates" --> J
    
    H -- "integrates" --> E4[create_subject_database.py]
    F -- "integrates" --> E4
    A -- "integrates" --> E4
    C -- "integrates" --> E4
    E4 -- "creates" --> K

    K -- "assembles" --> E3[generate_database.py]
    J -- "uses" --> E3
    E3 -- "creates" --> L

    classDef file fill:#fef9e7,stroke:#b08d57
    classDef script fill:#e8f8f5,stroke:#16a085
    class A,A_new,C,D,F,G,H,I,J,K,L,M,R file
    class E0,E1,E2,E3,E4,F_new script
