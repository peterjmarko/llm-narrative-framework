graph TD
    subgraph "Main Data Preparation Pipeline"
        A[src/filter_adb_candidates.py]
        B[src/prepare_sf_import.py]
        D[src/create_subject_db.py]
        C[src/generate_personalities_db.py]
    end

    subgraph "Optional Pre-flight Scripts"
        F_new[src/fetch_adb_data.py]
        V[src/validate_adb_data.py]
    end

    F_new --> A
    V -- "creates validation report for" --> A;
    A --> B;
    B --> D;
    D --> C;

    style A fill:#d4edda,stroke:#155724
    style B fill:#d4edda,stroke:#155724
    style D fill:#d4edda,stroke:#155724
    style C fill:#d4edda,stroke:#155724
    style F_new fill:#fff3cd,stroke:#f1c40f
    style V fill:#fff3cd,stroke:#f1c40f
    